- 작성일: 2023-05-04
- 태그: 
- 분류
    - [HTTP 메시지](HTTP%20메시지.md)
- 관련 노트
    - [HTTP 특징](HTTP%20특징.md) 
---

```
HTTP 쿠키 header
|
+-- Set-Cookie
|
+-- Cookie
```

HTTP 쿠키 헤더에 대해 알아보겠습니다.

---

# 특징

- 쿠키 정보는 항상 서버에 전송됩니다.
    - 추가적인 네트워크 트래픽을 유발합니다.
    - 최소한의 정보만 사용해야 합니다.
    - 서버에 전송하지 않고 웹 스토리지를 사용해 브라우저에 저장할 수 있습니다.
- 보안에 민감한 데이터를 저장하면 안 됩니다.

## 생명 주기

생명 주기를 지정할 수 있습니다.

- 만료일이 되면 쿠키를 삭제합니다.
- 0이나 음수를 지정하면 쿠키를 삭제합니다.
- e.g.
    - 세션 쿠키
        - 만료 날짜를 생략하면 브라우저 종료 시 까지 유지합니다.
    - 영속 쿠키
        - 만료 날짜를 지정하면 해당 날짜까지 유지합니다.

## 도메인

쿠키에 도메인을 명시 또는 생략 할 수 있습니다.


- 명시
    - 명시한 문서 기준 도메인 + 서브 도메인을 포함합니다.
    - e.g.
        - domain = example.org를 지정해서 쿠키를 생성합니다.
            - dev.example.org도 쿠키 접근이 가능합니다.
- 생략
    - 현재 문서 기준 도메인만 적용합니다.
    - e.g.
        - example.org에서 쿠키를 생성하고 domain 지정을 생략한 경우
            - example.com에서 쿠키 접근
            - dev.example.com는 쿠키 미접근

## 경로

쿠키에 경로를 지정할 수 있습니다.

- 경로를 지정할 수 있습니다.
    - 이 경로를 포함한 하위 경로 페이지만 쿠키 접근이 가능합니다.
- 일반적으로 path=/ 루트로 지정합니다.
    - e.g.
        - path=/home 지정
            - /home 접근 가능
            - /home/leve1 접근 가능
            - /home/level1/leve2 접근 가능
            - /hello 불가능

## 보안

쿠키와 보안에 관련된 특징입니다.

- 쿠키는 http, https 를 구분하지 않고 전송합니다.
    - Secure 적용 시 https인 경우만 전송합니다.
- HttpOnly
    - XSS 공격을 방지 하기 위해 사용합니다.
    - 적용 시 자바스크립트에서 접근이 불가능합니다.
    - HTTP 전송에서만 사용할 수 있습니다.
- SameSite
    - XSRF 공격을 방지하기 위해 사용합니다.
    - 요청 도메인과 쿠키에 설정된 도메인이 같은 경우만 쿠키를 전송합니다.

---
# 사용처

다음과 같은 곳에서 사용합니다.

- 사용자 로그인 세션 관리
- 광고 정보 트래킹

---

# 사용 예시

```
    +--------+                                   +-------+
    |  User  |                                   |Server |
    +--------+                                   +-------+
        |                                           |
        |            GET /login.html                |
        |------------------------------------------>|
        |                                           |
        |          HTML form with username          |
        |<------------------------------------------|
        |                                           |
        |   POST /login with username and password  |
        |------------------------------------------>|
        |                                           |
        |     Set-Cookie: session_id=123456789      |
        |<------------------------------------------|
        |                                           |
        |            GET /protected.html            |
        |     Cookie: session_id=123456789          |
        |------------------------------------------>|
        |                                           |
        |          HTML content of page             |
        |<------------------------------------------|
```

로그인 이후, 서버로 부터 세션 아이디를 받고, 요청에 세션 아이디를 포함하여 사용자를 식별할 수 있습니다.

---
# Reference

- [모든 개발자를 위한 HTTP 웹 기본 지식 - 인프런 | 강의 (inflearn.com)](https://www.inflearn.com/course/http-%EC%9B%B9-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC)